---
work_package_id: "WP01"
title: "Comment Trigger Contract"
lane: "planned"
dependencies: []
---

# WP01: Comment Trigger Contract

## Objective
Define how Figma comments trigger AI tasks.

## Context
Designers will leave comments on the Figma canvas to request AI assistance. We need a clear contract for which comments trigger the AI and which are normal human-to-human comments.

## Tasks

1. **Define primary trigger format**
   - Pattern: `Claude:` prefix (case-insensitive)
   - Examples: `Claude: fix spacing`, `claude: move this right`, `CLAUDE: delete this`

2. **Define secondary trigger (optional)**
   - Pattern: `/claude` at start of comment
   - Example: `/claude fix the alignment here`

3. **Document non-trigger behavior**
   - Plain comments without triggers = normal human comments
   - These are ignored by the AI system

4. **Create TypeScript types**
   - `CommentTrigger` interface
   - `TriggerType` enum
   - `isTriggerComment()` helper function

## Deliverables

- [ ] `figma-mcp-server/src/comments/triggers.ts` with type definitions
- [ ] Unit tests for trigger detection
- [ ] Documentation of trigger patterns

## Acceptance Criteria

- `Claude: do something` is detected as trigger
- `claude: do something` is detected (case-insensitive)
- `/claude do something` is detected (if secondary enabled)
- `Normal comment` is NOT detected as trigger
- `This mentions Claude but isn't a trigger` is NOT detected

## Technical Notes

```typescript
// Example interface
interface CommentTrigger {
  type: 'primary' | 'secondary';
  command: string;  // text after the trigger
  originalText: string;
  confidence: number;
}

function isTriggerComment(text: string): CommentTrigger | null {
  // Implementation
}
```
